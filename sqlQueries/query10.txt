SELECT extract (year from (to_date(to_char(cd.datetime,'dd-MON-yyyy')))) as "Year", s.name as "Symptom Name",  
count(cd.caseid) as "No of Cases", sum(cd.duration_min) as "Total Duration",  
to_char(Avg(cd.duration_min),'999.99') as "Average Duration", count(tripid) as "No of Trips"  
FROM symptoms s  
    JOIN case_symptoms cs ON s.symptomid = cs.symptomid 
    JOIN case_details cd ON cd.caseid = cs.caseid 
    LEFT OUTER JOIN trip_details td ON td.caseid = cd.caseid 
GROUP BY s.name,extract (year from (to_date(to_char(cd.datetime,'dd-MON-yyyy')))) 
ORDER BY extract (year from (to_date(to_char(cd.datetime,'dd-MON-yyyy'))))